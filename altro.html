<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro Voti</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 20px;
        }
        .form-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        select, input[type="date"], input[type="number"], button {
            padding: 10px;
            font-size: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 15px;
            text-align: center;
        }
        .delete-btn {
            color: red;
            font-weight: bold;
            cursor: pointer;
        }
        .delete-btn:hover {
            color: darkred;
        }
        /* Pulsante Salva in alto a sinistra */
        #save-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 10px 20px;
            font-size: 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        #save-btn:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>

    <button id="save-btn" onclick="saveToFirebase()">Salva</button>

    <h1>Registro Voti</h1>

    <div class="form-container">
        <label for="name">Nome e Cognome:</label>
        <select id="name">
            <option value="">-- Seleziona Nome e Cognome --</option>
            <option value="Stellina Dematteis">Stellina Dematteis</option>
            <option value="Tartaruga Benua">Tartaruga Benua</option>
            <option value="Yucky Benua">Yucky Benua</option>
            <!-- Aggiungere altri nomi qui -->
        </select>

        <label for="date">Data:</label>
        <input type="date" id="date">

        <label for="subject">Materia:</label>
        <select id="subject">
            <option value="">-- Seleziona Materia --</option>
            <option value="Italiano">Italiano</option>
            <option value="Matematica">Matematica</option>
            <!-- Aggiungere altre materie qui -->
        </select>

        <label for="grade">Voto:</label>
        <input type="number" id="grade" min="1" max="10" placeholder="Voto">

        <button onclick="addRecord()">Conferma</button>
    </div>

    <table>
        <thead>
            <tr>
                <th>Nome e Cognome</th>
                <th>Data</th>
                <th>Materia</th>
                <th>Voto</th>
                <th>Cancella</th>
            </tr>
        </thead>
        <tbody id="recordsTable">
        </tbody>
    </table>

    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-database.js"></script>

    <script>
        // Configura il tuo progetto Firebase qui
        const firebaseConfig = {
            apiKey: "TUA_API_KEY",
            authDomain: "TUA_AUTH_DOMAIN",
            databaseURL: "TUA_DATABASE_URL",
            projectId: "TUA_PROJECT_ID",
            storageBucket: "TUA_STORAGE_BUCKET",
            messagingSenderId: "TUA_MESSAGING_SENDER_ID",
            appId: "TUA_APP_ID"
        };

        // Inizializza Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        document.addEventListener("DOMContentLoaded", loadFromFirebase);

        function addRecord() {
            const name = document.getElementById('name').value;
            const date = document.getElementById('date').value;
            const subject = document.getElementById('subject').value;
            const grade = document.getElementById('grade').value;

            if (name && date && subject && grade) {
                const record = { name, date, subject, grade };
                addToTable(record);
            } else {
                alert("Per favore, compila tutti i campi.");
            }
        }

        function addToTable(record) {
            const table = document.getElementById('recordsTable');
            const row = table.insertRow();
            row.insertCell(0).innerText = record.name;
            row.insertCell(1).innerText = record.date;
            row.insertCell(2).innerText = record.subject;
            row.insertCell(3).innerText = record.grade;

            const deleteCell = row.insertCell(4);
            const deleteBtn = document.createElement("span");
            deleteBtn.innerText = "X";
            deleteBtn.classList.add("delete-btn");
            deleteBtn.onclick = () => {
                row.remove();
            };
            deleteCell.appendChild(deleteBtn);
        }

        // Funzione per salvare i voti in Firebase
        function saveToFirebase() {
            const records = [];
            const rows = document.querySelectorAll('#recordsTable tr');
            
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length > 0) {
                    const record = {
                        name: cells[0].innerText,
                        date: cells[1].innerText,
                        subject: cells[2].innerText,
                        grade: cells[3].innerText
                    };
                    records.push(record);
                }
            });

            if (records.length > 0) {
                db.ref('records').set(records)
                    .then(() => alert('Voti salvati con successo!'))
                    .catch(error => alert('Errore nel salvataggio: ' + error.message));
            } else {
                alert('Non ci sono voti da salvare.');
            }
        }

        // Funzione per caricare i voti da Firebase
        function loadFromFirebase() {
            db.ref('records').once('value', snapshot => {
                const records = snapshot.val();
                if (records) {
                    records.forEach(record => addToTable(record));
                }
            }).catch(error => alert('Errore nel caricamento: ' + error.message));
        }
    </script>

</body>
</html>
